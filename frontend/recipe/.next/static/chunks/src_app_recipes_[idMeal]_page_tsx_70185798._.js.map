{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/nikolai/Desktop/git/frontend/recipe/src/app/recipes/%5BidMeal%5D/page.tsx"],"sourcesContent":["// File: app/recipes/[idMeal]/page.tsx\n'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport Box from '@mui/material/Box';\nimport Typography from '@mui/material/Typography';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemButton from '@mui/material/ListItemButton';\nimport ListItemText from '@mui/material/ListItemText';\nimport Divider from '@mui/material/Divider';\nimport Paper from '@mui/material/Paper';\nimport Grid from '@mui/material/Grid';\nimport Image from 'next/image';\nimport Button from '@mui/material/Button';\n\n\ninterface RawMeal {\n  idMeal: string;\n  strMeal: string;\n  strCategory: string;\n  strArea: string;\n  strInstructions: string;\n  strMealThumb: string;\n  strTags: string | null;\n  strYoutube: string | null;\n  strSource: string | null;\n  strIngredient1: string;   strIngredient2: string; /* … strIngredient20 */\n  strMeasure1: string;      strMeasure2: string;    /* … strMeasure20 */\n}\n\ninterface LookupResponse {\n  meals: RawMeal[] | null;\n}\n\ninterface RawMealSummary {\n  idMeal: string;\n  strMeal: string;\n  strMealThumb: string;\n}\n\ninterface MealsResponse {\n  meals: RawMealSummary[] | null;\n}\n\n//////////////////////////////\n// 2) NORMALIZE HELPER      //\n//////////////////////////////\n\ninterface Ingredient {\n  name: string;\n  measure: string;\n}\n\ninterface Recipe {\n  id: string;\n  name: string;\n  category: string;\n  country: string;\n  instructions: string;\n  imageUrl: string;\n  youtubeUrl: string | null;\n  sourceUrl: string | null;\n  ingredients: Ingredient[];\n}\n\nfunction normalizeRawMeal(raw: RawMeal): Recipe {\n  const ingredients: Ingredient[] = [];\n  for (let i = 1; i <= 20; i++) {\n    const ingKey = (`strIngredient${i}` as keyof RawMeal);\n    const measureKey = (`strMeasure${i}` as keyof RawMeal);\n    const ingVal = raw[ingKey]?.trim();\n    const measureVal = raw[measureKey]?.trim();\n    if (ingVal && ingVal.length > 0) {\n      ingredients.push({ name: ingVal, measure: measureVal || '' });\n    }\n  }\n\n  return {\n    id: raw.idMeal,\n    name: raw.strMeal,\n    category: raw.strCategory,\n    country: raw.strArea,\n    instructions: raw.strInstructions,\n    imageUrl: raw.strMealThumb,\n    youtubeUrl: raw.strYoutube,\n    sourceUrl: raw.strSource,\n    ingredients,\n  };\n}\n\n\n\nconst BACKEND_BASE = 'http://localhost:3000';\n\nasync function fetchRecipeByIdMeal(idMeal: string): Promise<Recipe | null> {\n  const res = await fetch(`${BACKEND_BASE}/recipes/${idMeal}`, {\n    cache: 'no-store',\n  });\n  if (res.status === 404) return null;\n  if (!res.ok) throw new Error(`Failed to fetch recipe ${idMeal} (status ${res.status})`);\n\n  const data: LookupResponse = await res.json();\n  if (!data.meals || data.meals.length === 0) return null;\n  return normalizeRawMeal(data.meals[0]);\n}\n\nasync function fetchRecipesByCategory(category: string): Promise<Recipe[]> {\n  const listRes = await fetch(\n    `${BACKEND_BASE}/recipes?category=${encodeURIComponent(category)}`,\n    { cache: 'no-store' }\n  );\n  if (!listRes.ok) throw new Error(`Failed to fetch list for category ${category}`);\n\n  const listData: MealsResponse = await listRes.json();\n  if (!listData.meals) return [];\n\n  const lookupPromises = listData.meals.map((m) =>\n    fetch(`${BACKEND_BASE}/recipes/${m.idMeal}`, { cache: 'no-store' })\n      .then((r) => {\n        if (r.status === 404) return null;\n        if (!r.ok) throw new Error(`Lookup failed for ${m.idMeal}`);\n        return r.json() as Promise<LookupResponse>;\n      })\n      .then((resp) =>\n        resp && resp.meals && resp.meals.length > 0 ? normalizeRawMeal(resp.meals[0]) : null\n      )\n  );\n\n  const all = await Promise.all(lookupPromises);\n  return all.filter((r): r is Recipe => r !== null);\n}\n\n//////////////////////////////\n// 4) CLIENT‐SIDE PAGE      //\n//////////////////////////////\n\nexport default function RecipeInfoPage() {\n  const params = useParams();\n  const idMeal = params?.idMeal;\n  const router = useRouter();\n\n  const [recipe, setRecipe] = useState<Recipe | null>(null);\n  const [related, setRelated] = useState<Recipe[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!idMeal) return;\n\n    async function loadData() {\n      try {\n        const fetchedRecipe = await fetchRecipeByIdMeal(idMeal);\n        if (!fetchedRecipe) {\n          router.push('/404');\n          return;\n        }\n        setRecipe(fetchedRecipe);\n\n        // Fetch “More in this category”\n        const fetchedRelated = await fetchRecipesByCategory(fetchedRecipe.category);\n        setRelated(fetchedRelated.filter((r) => r.id !== fetchedRecipe.id));\n      } catch (err: any) {\n        setError(err.message || 'An unexpected error occurred');\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    loadData();\n  }, [idMeal, router]);\n\n  if (loading) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center' }}>\n        <Typography variant=\"h6\">Loading recipe…</Typography>\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center' }}>\n        <Typography variant=\"h6\" color=\"error\">\n          Error: {error}\n        </Typography>\n      </Box>\n    );\n  }\n\n  if (!recipe) return null; // already redirected to 404\n\n  return (\n    <Box sx={{ p: 2 }}>\n      <Grid container spacing={4}>\n        {/* LEFT COLUMN */}\n        <Grid item xs={12} md={8}>\n          <Paper elevation={2} sx={{ p: 2 }}>\n            {/* IMAGE + NAME + COUNTRY */}\n            <Box\n              sx={{\n                display: 'flex',\n                flexDirection: { xs: 'column', md: 'row' },\n                alignItems: 'center',\n                mb: 3,\n              }}\n            >\n              <Box sx={{ flexShrink: 0, mr: { md: 3 }, mb: { xs: 2, md: 0 } }}>\n                <Image\n                  src={recipe.imageUrl}\n                  alt={recipe.name}\n                  width={200}\n                  height={200}\n                  style={{ borderRadius: 8, objectFit: 'cover' }}\n                />\n              </Box>\n              <Box sx={{ textAlign: { xs: 'center', md: 'left' } }}>\n                <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n                  {recipe.name}\n                </Typography>\n                <Typography variant=\"body1\" color=\"text.secondary\">\n                  Country:{' '}\n                  <Link href={`/recipes/country/${encodeURIComponent(recipe.country)}`}>\n                    <Typography\n                      component=\"a\"\n                      variant=\"body1\"\n                      sx={{\n                        color: 'primary.main',\n                        textDecoration: 'none',\n                        '&:hover': { textDecoration: 'underline' },\n                      }}\n                    >\n                      {recipe.country}\n                    </Typography>\n                  </Link>\n                </Typography>\n              </Box>\n            </Box>\n\n            <Divider sx={{ mb: 3 }} />\n\n            {/* INSTRUCTIONS */}\n            <Box sx={{ mb: 3 }}>\n              <Typography variant=\"h5\" gutterBottom>\n                Instructions\n              </Typography>\n              <Typography variant=\"body1\" sx={{ whiteSpace: 'pre-line' }}>\n                {recipe.instructions}\n              </Typography>\n            </Box>\n\n            {/* INGREDIENTS */}\n            <Box>\n              <Typography variant=\"h5\" gutterBottom>\n                Ingredients\n              </Typography>\n              <List>\n                {recipe.ingredients.map((ing) => (\n                  <ListItem key={ing.name} disablePadding>\n                    <ListItemButton\n                      component={Link}\n                      href={`/recipes/ingredient/${encodeURIComponent(ing.name)}`}\n                    >\n                      <ListItemText\n                        primary={`${ing.name} (${ing.measure})`}\n                        primaryTypographyProps={{ color: 'primary.main' }}\n                      />\n                    </ListItemButton>\n                  </ListItem>\n                ))}\n              </List>\n            </Box>\n          </Paper>\n        </Grid>\n\n        {/* RIGHT SIDEBAR */}\n        <Grid item xs={12} md={4}>\n          <Paper elevation={2} sx={{ p: 2 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              More in “{recipe.category}”\n            </Typography>\n            <List>\n              {related.map((r) => (\n                <ListItem key={r.id} disablePadding>\n                  <ListItemButton component={Link} href={`/recipes/${r.id}`}>\n                    <ListItemText primary={r.name} />\n                  </ListItemButton>\n                </ListItem>\n              ))}\n            </List>\n            <Box sx={{ mt: 2 }}>\n              <Button\n                variant=\"outlined\"\n                component={Link}\n                href={`/recipes/category/${encodeURIComponent(recipe.category)}`}\n                fullWidth\n              >\n                View all “{recipe.category}”\n              </Button>\n            </Box>\n          </Paper>\n        </Grid>\n      </Grid>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}